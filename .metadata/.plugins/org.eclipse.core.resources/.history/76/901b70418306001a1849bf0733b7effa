package com.example.spring02.controller.shop;

import javax.inject.Inject;
import javax.servlet.http.HttpSession;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.RequestMapping;

import com.example.spring02.model.shop.dto.CartDTO;
import com.example.spring02.service.shop.CartService;

@Controller
@RequestMapping("/cart/*") // 공통적인 url mapping
public class CartController {

	@Inject
	CartService cartService;
	
	@RequestMapping("insert.do") // 세부적인 url mapping
	public String insert(@ModelAttribute CartDTO dto, HttpSession session) {
		// 로그인 여부를 체크하기 위해 세션에 저장된 아이디 확인
		String userid=(String)session.getAttribute("userid");
		if(userid == null) {
			return "redirect:/member/login.do";
		}
		dto.setUserid(userid);
		cartService.insert(dto); // 장바구니 테이블에 저장됨
		return "redirect:/shop/cart/list.do"; // 장바구니 목록으로 이동
	}
	
}
